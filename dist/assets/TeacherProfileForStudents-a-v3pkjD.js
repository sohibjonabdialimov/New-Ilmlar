import{a as w,r as v,P as S,u as y,s as _,b as p,d as k,j as s,f as P,B as C,E as B,e as M}from"./index-EQTJMyC9.js";import{t as z}from"./teacher_avatar-BnTJq1H-.js";import{S as G,f as O,N as T,a as b}from"./free-mode-Dp-rY5qK.js";import{N as V}from"./NewCourseCard-DTkejjsl.js";import{u as E}from"./useQueries-DhCaOJLO.js";import{S as K}from"./index-DxBGnKrw.js";import{C as L}from"./CardSkeleton-CNyQ4Sdz.js";import{s as R}from"./profile-p_2tWCld.js";import"./formatPrice-DtFitVZE.js";const Y=()=>{var x;const{id:t}=w(),{userData:i}=v.useContext(S),c=y(),[f,u]=_.useMessage(),{data:m,isLoading:g,refetch:j}=p(["GetSubscription",t],()=>k(t),{enabled:!!t&&!!(i!=null&&i.id)}),{data:o}=p(["GetTeacherAccount"],()=>M(t),{enabled:!!t}),d=a=>{i!=null&&i.id?P(a).then(()=>{j()}).catch(()=>{f.open({type:"error",content:s.jsx("h1",{className:"text-lg",children:"Xatolik yuz berdi. Saytni yangilab, boshidan urinib ko'ring"})})}):R.open({message:s.jsx("h2",{className:"font-medium",children:"Avval ro'yxatdan o'ting!"}),description:"Siz ro'yxatdan o'tgandan keyin obuna bo'la olasiz",placement:"top",duration:3,btn:s.jsx(C,{type:"primary",onClick:()=>c("/register"),children:"Ro'yxatdan o'tish"})})},e=o==null?void 0:o.data.data;console.log(e);const h=async a=>{const{data:n}=await B.get(`/api/courses/course/${a}/withouttoken`);return n},l=E((((x=o==null?void 0:o.data.data)==null?void 0:x.courses)||[]).map(({id:a})=>({queryKey:["resource",a],queryFn:()=>h(a),enabled:!!a}))),N=l.some(a=>a.isLoading),r=l==null?void 0:l.map(a=>{var n;return(n=a==null?void 0:a.data)==null?void 0:n.data}).filter(a=>a!==void 0).filter(a=>a.status===2&&a.is_verified);return s.jsxs("div",{className:"sm:py-7 pt-7 pb-0 mb-16",children:[u,s.jsxs("div",{className:"flex justify-between sm:flex-row flex-col gap-5 sm:mb-16 mb-10",children:[s.jsxs("div",{className:"flex items-start sm:gap-5 gap-3",children:[s.jsx("img",{className:"sm:w-[142px] sm:h-[146px] w-[84px] h-[102px] sm:rounded-lg rounded-[5px] object-cover",src:e!=null&&e.profile_img?e==null?void 0:e.profile_img:z,alt:""}),s.jsxs("div",{className:"flex sm:gap-1.5 gap-1 justify-between flex-col",children:[s.jsxs("h1",{className:"text-main_color font-semibold sm:text-xl text-base mb-1",children:[e==null?void 0:e.first_name," ",e==null?void 0:e.last_name]}),s.jsx("p",{className:"text-[#758195] sm:text-base text-xs font-medium",children:e==null?void 0:e.spiceal}),s.jsx("p",{className:"text-[#758195] sm:text-base text-xs font-medium",children:e==null?void 0:e.link}),s.jsxs("p",{className:"text-[#758195] sm:text-base text-xs font-semibold",children:["Kurslar soni:"," ",s.jsxs("span",{className:"font-normal",children:[e==null?void 0:e.courses.length," ta"]})]}),s.jsxs("p",{className:"text-[#758195] sm:text-base text-xs font-semibold",children:["Obunachilar soni:"," ",s.jsxs("span",{className:"font-normal",children:[e==null?void 0:e.subscribedStudentsCount," ta"]})]})]})]}),s.jsx("div",{className:"sm:w-auto w-full",children:g?s.jsx(K,{className:"p-1 rounded-2xl",width:120}):m!=null&&m.data.data.subscribed?s.jsx("button",{onClick:a=>{a.stopPropagation(),d(t)},className:"unbtn text-sm sm:p-[10px_30px] p-[8px_20px] w-full",children:"Obuna bo'lgansiz"}):s.jsx("button",{onClick:a=>{a.stopPropagation(),d(t)},className:"btn text-sm sm:p-[10px_30px] p-[8px_20px] w-full",children:"Obuna bo’lish"})})]}),s.jsxs("div",{className:"sm:p-6 p-4 bg-[#f1f2f466] rounded-[16px] sm:mb-16 mb-6",children:[s.jsx("h2",{className:"sm:text-3xl text-lg text-main_color font-semibold sm:mb-6 mb-2",children:"O'qituvchi haqida ma’lumot"}),s.jsx("p",{className:"sm:text-xl sm:leading-8 text-sm",children:e==null?void 0:e.info})]}),s.jsxs("div",{className:"relative mt-14 sm:mb-5 mb-5",children:[s.jsx("h1",{className:"title absolute top-0",children:"Kurslar"}),s.jsx(G,{slidesPerView:1.2,spaceBetween:10,navigation:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:16},768:{slidesPerView:3,spaceBetween:16},1024:{slidesPerView:4,spaceBetween:16}},freeMode:!0,modules:[O,T],className:"mySwiper",children:N?[1,2,3,4].map(a=>s.jsx(b,{children:s.jsx(L,{})},a)):r==null?void 0:r.map(a=>s.jsx(b,{children:s.jsx(V,{item:a})},a.id))})]})]})};export{Y as default};
