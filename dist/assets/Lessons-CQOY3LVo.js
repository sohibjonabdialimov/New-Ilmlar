import{u as O,r,a as T,L as q,b as $,j as e,S as z,D as W,h as K,G as M}from"./index-CgAySD3q.js";import{P as Q}from"./player.es-Dnu63r5Q.js";const A=()=>{var y,v,k,w;const f=O(),[p,C]=r.useState(null),{id:n,lessonId:d}=T(),[L,h]=r.useState(!1),[j,b]=r.useState(!1),[S,N]=r.useState(!1),{lessons:l,setLessons:g,isPurchased:o}=r.useContext(q),{data:u}=$(["GetCourseDetailWithoutToken",n],()=>K(n),{enabled:!!n});r.useEffect(()=>{var s,a;(a=(s=u==null?void 0:u.data)==null?void 0:s.data)!=null&&a.videos&&g(u.data.data.videos)},[u,g]);const{data:t,isLoading:P}=$(["GetVideoInfo",d,n],()=>M(d),{enabled:!!d&&!!n,onSuccess(s){C(s.data.data.video_link.split("/")[s.data.data.video_link.split("/").length-1])}});r.useEffect(()=>{const s=document.querySelector("iframe");if(s){const a=new Q(s);a.on("play",()=>{console.log("Played the video")}),a.getVideoTitle().then(i=>{console.log("title:",i)})}},[p]);function E(s,a){(a||o)&&(f(`/course/${s}/lesson/${s}`),h(!1))}r.useEffect(()=>{var i,x,c;const s=l.findIndex(m=>m.id===+d),a=o?!!((i=l[s+1])!=null&&i.id):!!((x=l[s+1])!=null&&x.id)&&((c=l[s+1])==null?void 0:c.is_free);s!==-1&&(b(!s),N(!a))},[l,d,o]);function G(s){var c,m,I,_;const a=l.findIndex(F=>F.id===s),i=(c=l[a+1])==null?void 0:c.id;(o?(m=l[a+1])!=null&&m.id:(I=l[a+1])!=null&&I.id&&((_=l[a+1])!=null&&_.is_free))&&f(`/course/${n}/lesson/${i}`)}function V(s){var x;const a=l.findIndex(c=>c.id===s),i=(x=l[a-1])==null?void 0:x.id;j||!i||f(`/course/${s}/lesson/${i}`)}function B(){f(o?`/my-course/${n}`:`/course/${n}`)}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"sm:py-7 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{onClick:B,className:"inline-flex items-center sm:gap-3 gap-1 cursor-pointer font-medium",children:[e.jsx("i",{className:"fa-solid fa-arrow-left sm:text-base text-xs"}),e.jsx("button",{className:"sm:text-lg text-sm",children:"Ortga qaytish"})]}),e.jsx("div",{className:"cursor-pointer mobile_lessons_menu",onClick:()=>h(!0),children:e.jsx("i",{className:"fa-solid fa-list-ul text-xl"})})]}),e.jsxs("div",{className:"sm:pt-5 pt-3",children:[e.jsx("div",{className:"h-[50%] rounded-[16px]",children:P?e.jsx("div",{className:"flex justify-center h-[10rem] items-center",children:e.jsx(z,{size:"large"})}):p?e.jsx("iframe",{src:`https://player.vimeo.com/video/${p}?h=2ac395a2694246448051ee01faf135ce&title=0&byline=0&portrait=0`,className:"w-full aspect-[7/4] rounded-[16px]",frameBorder:0,allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0}):e.jsx("p",{children:"Video topilmadi yoki noto'g'ri ID."})}),e.jsxs("div",{children:[e.jsx("h1",{className:"sm:text-2xl text-lg sm:pt-7 pt-4 font-semibold sm:pb-3 pb-2 text-main_color",children:(y=t==null?void 0:t.data.data)==null?void 0:y.title}),e.jsx("p",{className:"text-[#758195] pb-6 sm:text-lg text-sm",children:(v=t==null?void 0:t.data.data)==null?void 0:v.description}),((k=t==null?void 0:t.data.data)==null?void 0:k.file)&&e.jsx("div",{className:"sm:mb-6 mb-4",children:e.jsx("a",{target:"_blank",href:(w=t==null?void 0:t.data.data)==null?void 0:w.file,className:"text-blue_color sm:text-xl text-base font-normal underline",children:"Darsga oid fayl"})}),e.jsx("hr",{}),e.jsxs("div",{className:"sm:mt-6 mt-4 flex justify-between",children:[e.jsxs("button",{onClick:()=>V(t==null?void 0:t.data.data.id),className:`flex items-center gap-3 ${j?"cursor-not-allowed opacity-35":"cursor-pointer opacity-100"}`,children:[e.jsx("i",{className:"fa-solid fa-arrow-left-long sm:text-xl text-base"}),e.jsx("span",{className:"sm:text-xl text-base",children:"Oldingi dars"})]}),e.jsxs("button",{onClick:()=>G(t==null?void 0:t.data.data.id),className:`flex items-center gap-3 ${S?"cursor-not-allowed opacity-35":"cursor-pointer opacity-100"}`,children:[e.jsx("span",{className:"sm:text-xl text-base",children:"Keyingi dars"}),e.jsx("i",{className:"fa-solid fa-arrow-right-long sm:text-xl text-base"})]})]})]})]}),e.jsx(W,{className:"lesson_drawer",title:e.jsx("h3",{className:"text-[20px] font-semibold",children:"Mavzular ro'yxati"}),onClose:()=>h(!1),open:L,children:e.jsx("div",{className:"fixed bg-[#fff] text-[#09090BFF] h-[100dvh] overflow-y-scroll py-5",children:e.jsx("ul",{children:l==null?void 0:l.map((s,a)=>e.jsxs("li",{onClick:()=>E(s.id,s.is_free),className:`px-4 flex transition-colors py-5 items-center border-b-2 gap-2 hover:bg-[#eee] ${s!=null&&s.is_free||o?"opacity-100 cursor-pointer select-auto":"opacity-40 cursor-not-allowed select-none"} ${(s==null?void 0:s.id)==d?"bg-[#dfdfdf]":"bg-transparent"}`,children:[s!=null&&s.is_free||o?e.jsx("i",{className:"fa-regular fa-circle-play inline-block text-base"}):e.jsx("i",{className:"fa-solid fa-lock inline-block text-base"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("p",{className:"text-base font-normal",children:["#",a+1,"."]}),e.jsx("h1",{className:"line-clamp-1 text-base font-normal",children:s.title})]})]},s.id))})})})]})})};export{A as default};
