import{u as O,r as c,a as z,L as T,b as w,j as e,S as W,D as q,h as K,G as M}from"./index-EQTJMyC9.js";import{V as Q}from"./VimeoPlayer-BkJClxdB.js";const A=()=>{var v,y,I,k;const f=O(),[h,C]=c.useState(null),{id:n,lessonId:d}=z(),[L,p]=c.useState(!1),[j,b]=c.useState(!1),[S,N]=c.useState(!1),{lessons:a,setLessons:g,isPurchased:l}=c.useContext(T),{data:u}=w(["GetCourseDetailWithoutToken",n],()=>K(n),{enabled:!!n});c.useEffect(()=>{var s,i;(i=(s=u==null?void 0:u.data)==null?void 0:s.data)!=null&&i.videos&&g(u.data.data.videos)},[u,g]);const{data:t,isLoading:V}=w(["GetVideoInfo",d,n],()=>M(d),{enabled:!!d&&!!n,onSuccess(s){C(s.data.data.video_link.split("/")[s.data.data.video_link.split("/").length-1])}});function G(s,i){(i||l)&&(f(`/course/${s}/lesson/${s}`),p(!1))}c.useEffect(()=>{var r,x,o;const s=a.findIndex(m=>m.id===+d),i=l?!!((r=a[s+1])!=null&&r.id):!!((x=a[s+1])!=null&&x.id)&&((o=a[s+1])==null?void 0:o.is_free);s!==-1&&(b(!s),N(!i))},[a,d,l]);function P(s){var o,m,_,$;const i=a.findIndex(F=>F.id===s),r=(o=a[i+1])==null?void 0:o.id;(l?(m=a[i+1])!=null&&m.id:(_=a[i+1])!=null&&_.id&&(($=a[i+1])!=null&&$.is_free))&&f(`/course/${n}/lesson/${r}`)}function E(s){var x;const i=a.findIndex(o=>o.id===s),r=(x=a[i-1])==null?void 0:x.id;j||!r||f(`/course/${s}/lesson/${r}`)}function B(){f(l?`/my-course/${n}`:`/course/${n}`)}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"sm:py-7 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{onClick:B,className:"inline-flex items-center sm:gap-3 gap-1 cursor-pointer font-medium",children:[e.jsx("i",{className:"fa-solid fa-arrow-left sm:text-base text-xs"}),e.jsx("button",{className:"sm:text-lg text-sm",children:"Ortga qaytish"})]}),e.jsx("div",{className:"cursor-pointer mobile_lessons_menu",onClick:()=>p(!0),children:e.jsx("i",{className:"fa-solid fa-list-ul text-xl"})})]}),e.jsxs("div",{className:"sm:pt-5 pt-3",children:[e.jsx("div",{className:"h-[50%] rounded-[16px]",children:V?e.jsx("div",{className:"flex justify-center h-[10rem] items-center",children:e.jsx(W,{size:"large"})}):h?e.jsx(Q,{videoId:h}):e.jsx("p",{children:"Video topilmadi yoki noto'g'ri ID."})}),e.jsxs("div",{children:[e.jsx("h1",{className:"sm:text-2xl text-lg sm:pt-7 pt-4 font-semibold sm:pb-3 pb-2 text-main_color",children:(v=t==null?void 0:t.data.data)==null?void 0:v.title}),e.jsx("p",{className:"text-[#758195] pb-6 sm:text-lg text-sm",children:(y=t==null?void 0:t.data.data)==null?void 0:y.description}),((I=t==null?void 0:t.data.data)==null?void 0:I.file)&&e.jsx("div",{className:"sm:mb-6 mb-4",children:e.jsx("a",{target:"_blank",href:(k=t==null?void 0:t.data.data)==null?void 0:k.file,className:"text-blue_color sm:text-xl text-base font-normal underline",children:"Darsga oid fayl"})}),e.jsx("hr",{}),e.jsxs("div",{className:"sm:mt-6 mt-4 flex justify-between",children:[e.jsxs("button",{onClick:()=>E(t==null?void 0:t.data.data.id),className:`flex items-center gap-3 ${j?"cursor-not-allowed opacity-35":"cursor-pointer opacity-100"}`,children:[e.jsx("i",{className:"fa-solid fa-arrow-left-long sm:text-xl text-base"}),e.jsx("span",{className:"sm:text-xl text-base",children:"Oldingi dars"})]}),e.jsxs("button",{onClick:()=>P(t==null?void 0:t.data.data.id),className:`flex items-center gap-3 ${S?"cursor-not-allowed opacity-35":"cursor-pointer opacity-100"}`,children:[e.jsx("span",{className:"sm:text-xl text-base",children:"Keyingi dars"}),e.jsx("i",{className:"fa-solid fa-arrow-right-long sm:text-xl text-base"})]})]})]})]}),e.jsx(q,{className:"lesson_drawer",title:e.jsx("h3",{className:"text-[20px] font-semibold",children:"Mavzular ro'yxati"}),onClose:()=>p(!1),open:L,children:e.jsx("div",{className:"fixed bg-[#fff] text-[#09090BFF] h-[100dvh] overflow-y-scroll py-5",children:e.jsx("ul",{children:a==null?void 0:a.map((s,i)=>e.jsxs("li",{onClick:()=>G(s.id,s.is_free),className:`px-4 flex transition-colors py-5 items-center border-b-2 gap-2 hover:bg-[#eee] ${s!=null&&s.is_free||l?"opacity-100 cursor-pointer select-auto":"opacity-40 cursor-not-allowed select-none"} ${(s==null?void 0:s.id)==d?"bg-[#dfdfdf]":"bg-transparent"}`,children:[s!=null&&s.is_free||l?e.jsx("i",{className:"fa-regular fa-circle-play inline-block text-base"}):e.jsx("i",{className:"fa-solid fa-lock inline-block text-base"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("p",{className:"text-base font-normal",children:["#",i+1,"."]}),e.jsx("h1",{className:"line-clamp-1 text-base font-normal",children:s.title})]})]},s.id))})})})]})})};export{A as default};
