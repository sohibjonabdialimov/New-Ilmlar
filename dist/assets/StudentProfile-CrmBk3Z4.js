import{r as o,E as q,az as G,s as L,b as j,aA as z,j as e,aB as U,aC as M,F as r,H as c,x as d,aD as A,aE as H,A as Q,aF as $,aG as J}from"./index-B8td7unY.js";import{u as K,t as Z}from"./teacher_avatar-C7gH-DrR.js";import{S as w,f as g,N,a as y}from"./free-mode-CQ7EpK_r.js";import{N as _}from"./NewCourseCard-C5T699I0.js";import{T as W}from"./TeachersGroupCard-1qmqzQy_.js";import"./profile-CJRS_RRn.js";import"./index-CkdTVInk.js";import"./formatPrice-DC00fQPP.js";const re=()=>{var v,F;const[E,m]=o.useState(!1),{control:i,getValues:S,setValue:t,reset:k}=q(),{userData:s,setUserData:C}=o.useContext(G),x=o.useRef(null),[I,B]=L.useMessage(),{refetch:P}=j(["GetUsersUserme"],()=>z(localStorage.getItem("token")),{onSuccess:a=>{C(a.data.data),localStorage.setItem("user-data",JSON.stringify(a.data.data))}},{enable:!!localStorage.getItem("token")});o.useEffect(()=>{t("EDITPROFILE.user_name",s.user_name),t("EDITPROFILE.first_name",s.first_name),t("EDITPROFILE.last_name",s.last_name),t("EDITPROFILE.email",s.email)},[s,t]);const T=()=>{x.current&&x.current.click()},V=a=>{const l=a.target.files[0];l&&A({file:l}).then(()=>{P(),I.open({type:"info",content:"Rasm o'zgartirildi"})}).catch(n=>{console.log(n),I.open({type:"error",content:"Rasm yuklashda xatolik bor"})})},R=async()=>{const a=S().EDITPROFILE;console.log(a),H(a).then(()=>{P(),k(),m(!1)}).catch(l=>{console.log(l)})},{data:p}=j(["GetPurchasedCourses"],$),{data:u}=j(["GetSavedCourses"],J);let h=p==null?void 0:p.data.data,f=u==null?void 0:u.data.data;const O=async a=>{const{data:l}=await Q.get(`/api/users/teacheraccout/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}});return l},b=K(s==null?void 0:s.subscribedTeachers.map(a=>({queryKey:["data",a],queryFn:()=>O(a),enabled:!!(s!=null&&s.subscribedTeachers.length)})));return e.jsxs("div",{className:"py-7",children:[B,e.jsxs("div",{className:"flex sm:flex-row flex-col justify-between sm:mb-16 mb-0",children:[e.jsxs("div",{className:"sm:w-[78%] w-full",children:[e.jsxs("div",{className:"flex sm:flex-row flex-col items-center sm:gap-5 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{className:"sm:w-[142px] sm:h-[142px] object-cover w-[90px] h-[90px] rounded-full",src:s!=null&&s.profile_img?s==null?void 0:s.profile_img:Z,alt:"Ilmlar o'qituvchisining rasmi"}),e.jsx("div",{onClick:T,className:"border rounded-3xl translate-x-1/2 right-1/2 p-[4px_5px] inline-block absolute -bottom-3 text-xs text-white bg-[#262C36FF] cursor-pointer",children:"O'zgartirish"}),e.jsx("input",{type:"file",ref:x,className:"hidden",onChange:V})]}),e.jsxs("div",{className:"flex justify-between flex-col items-center sm:items-start py-1",children:[e.jsxs("h1",{className:"text-main_color font-semibold text-xl mb-1",children:[s==null?void 0:s.first_name," ",s!=null&&s.last_name?s==null?void 0:s.last_name:""," ",s!=null&&s.middle_name?s==null?void 0:s.middle_name:""]}),e.jsxs("p",{className:"text-base font-semibold",children:["Foydalanuvchi nomi:"," ",e.jsx("span",{className:"font-normal",children:s==null?void 0:s.user_name})]}),e.jsxs("p",{className:"text-base font-semibold",children:["Email: ",e.jsx("span",{className:"font-normal",children:s==null?void 0:s.email})]}),e.jsxs("p",{className:"text-base font-semibold",children:["Sotib olgan kurslaringiz soni:"," ",e.jsx("span",{className:"font-normal",children:"2 ta"})]})]})]}),e.jsx("div",{className:"sm:mt-5 mt-2 flex sm:justify-start justify-center items-center",children:e.jsx("button",{onClick:()=>m(!0),className:"btn text-sm sm:p-[10px_30px] p-[8px_20px]",children:"Profilni tahrirlash"})})]}),e.jsxs("div",{className:"relative h-full sm:w-[22%] w-full sm:block hidden",children:[e.jsx("img",{className:"aspect-[25/16] h-full w-full",src:U,alt:"Student's Plastic card"}),e.jsxs("p",{className:"absolute bottom-20 left-5 font-medium text-xl text-white",children:[(v=s==null?void 0:s.amount)!=null&&v.balance?(F=s==null?void 0:s.amount)==null?void 0:F.balance.toFixed(1):0," ","UZS"]}),e.jsx("p",{className:"absolute bottom-3 left-3 text-base text-white",children:s==null?void 0:s.payment_id})]})]}),e.jsxs("div",{className:"relative mt-14 mb-14",children:[e.jsx("h1",{className:"title absolute top-0",children:"Sotib olingan kurslar"}),e.jsx(w,{slidesPerView:1.5,spaceBetween:16,navigation:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:16},768:{slidesPerView:3,spaceBetween:16},1024:{slidesPerView:4,spaceBetween:16}},freeMode:!0,modules:[g,N],className:"mySwiper",children:h==null?void 0:h.map(a=>e.jsx(y,{children:e.jsx(_,{item:a,buy:!0,type:!0})},a==null?void 0:a.id))})]}),e.jsxs("div",{className:"relative mt-14 mb-14",children:[e.jsx("h1",{className:"title absolute top-0",children:"Saqlangan kurslar"}),e.jsx(w,{slidesPerView:1.5,spaceBetween:16,navigation:!0,freeMode:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:16},768:{slidesPerView:3,spaceBetween:16},1024:{slidesPerView:4,spaceBetween:16}},modules:[g,N],className:"mySwiper",children:f==null?void 0:f.map(a=>e.jsx(y,{className:"",children:e.jsx(_,{save:!0,item:a})},a==null?void 0:a.id))})]}),e.jsxs("div",{className:"relative mt-14 sm:mb-5 mb-10",children:[e.jsx("h1",{className:"title absolute top-0",children:"Obunalar"}),e.jsx(w,{slidesPerView:2,spaceBetween:15,navigation:!0,freeMode:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:20},768:{slidesPerView:4,spaceBetween:24},1024:{slidesPerView:5,spaceBetween:24},1440:{slidesPerView:6,spaceBetween:24}},modules:[g,N],className:"mySwiper",children:b==null?void 0:b.map(a=>{var l,n;return e.jsx(y,{className:"",children:e.jsx(W,{item:(l=a==null?void 0:a.data)==null?void 0:l.data,type:!0})},(n=a==null?void 0:a.data)==null?void 0:n.data.id)})})]}),e.jsx(M,{title:"Profilni tahrirlash",onClose:()=>m(!1),open:E,children:e.jsx(r,{layout:"vertical",className:"w-full",onSubmitCapture:a=>{a.preventDefault(),R()},children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Ism"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.first_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Ismingizni kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Familiya"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.last_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Familiyangizni kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Foydalanuvchi nomi"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.user_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Foydalanuvchi nomini kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{className:"",label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Email"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.email",render:({field:a})=>e.jsx(d,{...a,type:"email",placeholder:"email@gmail.com",className:"w-full py-3 px-5 rounded-[10px]"})})}),e.jsx("button",{type:"submit",className:"w-full text-base py-2 text-white rounded-2xl bg-blue_color cursor-pointer transition-opacity hover:opacity-85",children:"Saqlash"})]})})})]})};export{re as default};
