import{r as o,H as U,P as z,s as M,b as f,aC as H,aD as A,aE as W,j as e,aF as $,D as J,F as r,J as c,y as d,aG as K,aH as Q,E as Z}from"./index-CgAySD3q.js";import{t as X}from"./teacher_avatar-BnTJq1H-.js";import{S as b,f as j,N as w,a as g}from"./free-mode-8GCapM2R.js";import{N as k}from"./NewCourseCard-B_P3-Bac.js";import{T as Y}from"./TeachersGroupCard-MV2mBXHK.js";import{u as D}from"./useQueries-EDoR5p16.js";import"./profile-CfPfgSv3.js";import"./formatPrice-DtFitVZE.js";const oe=()=>{var P,v,I,F,_,E,S;const[C,m]=o.useState(!1),{control:i,getValues:T,setValue:t,reset:B}=U(),{userData:s,setUserData:V}=o.useContext(z),x=o.useRef(null),[N,R]=M.useMessage();o.useEffect(()=>{t("EDITPROFILE.user_name",s.user_name),t("EDITPROFILE.first_name",s.first_name),t("EDITPROFILE.last_name",s.last_name),t("EDITPROFILE.email",s.email)},[s,t]);const q=()=>{x.current&&x.current.click()},O=a=>{const l=a.target.files[0];l&&K({file:l}).then(()=>{y(),N.open({type:"info",content:"Rasm o'zgartirildi"})}).catch(n=>{console.log(n),N.open({type:"error",content:"Rasm yuklashda xatolik bor"})})},G=async()=>{const a=T().EDITPROFILE;console.log(a),Q(a).then(()=>{y(),B(),m(!1)}).catch(l=>{console.log(l)})},{data:p}=f(["GetPurchasedCourses"],H,{enabled:!!(s!=null&&s.id)}),{data:u}=f(["GetSavedCourses"],A,{enabled:!!(s!=null&&s.id)}),{refetch:y}=f(["GetUsersUsermeWithoutStorage"],W,{enabled:!!localStorage.getItem("token"),onSuccess:a=>{V(a.data.data)}}),L=async a=>{const{data:l}=await Z.get(`/api/users/teacheraccout/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}});return l},h=D(((P=s==null?void 0:s.subscribedTeachers)==null?void 0:P.length)>0?s.subscribedTeachers.map(a=>({queryKey:["data",a],queryFn:()=>L(a),enabled:!!a})):[]);return e.jsxs("div",{className:"py-7",children:[R,e.jsxs("div",{className:"flex sm:flex-row flex-col justify-between sm:mb-16 mb-0",children:[e.jsxs("div",{className:"sm:w-[78%] w-full",children:[e.jsxs("div",{className:"flex sm:flex-row flex-col items-center sm:gap-5 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{className:"sm:w-[142px] sm:h-[142px] object-cover w-[90px] h-[90px] rounded-full",src:s!=null&&s.profile_img?s==null?void 0:s.profile_img:X,alt:"Ilmlar o'qituvchisining rasmi"}),e.jsx("div",{onClick:q,className:"border rounded-3xl translate-x-1/2 right-1/2 p-[4px_5px] inline-block absolute -bottom-3 text-xs text-white bg-[#262C36FF] cursor-pointer",children:"O'zgartirish"}),e.jsx("input",{type:"file",ref:x,className:"hidden",onChange:O})]}),e.jsxs("div",{className:"flex justify-between flex-col items-center sm:items-start py-1",children:[e.jsxs("h1",{className:"text-main_color font-semibold text-xl mb-1",children:[s==null?void 0:s.first_name," ",s!=null&&s.last_name?s==null?void 0:s.last_name:""," ",s!=null&&s.middle_name?s==null?void 0:s.middle_name:""]}),e.jsxs("p",{className:"text-base font-semibold",children:["Foydalanuvchi nomi:"," ",e.jsx("span",{className:"font-normal",children:s==null?void 0:s.user_name})]}),e.jsxs("p",{className:"text-base font-semibold",children:["Email: ",e.jsx("span",{className:"font-normal",children:s==null?void 0:s.email})]}),e.jsxs("p",{className:"text-base font-semibold",children:["Sotib olgan kurslaringiz soni:"," ",e.jsx("span",{className:"font-normal",children:"2 ta"})]})]})]}),e.jsx("div",{className:"sm:mt-5 mt-2 flex sm:justify-start justify-center items-center",children:e.jsx("button",{onClick:()=>m(!0),className:"btn text-sm sm:p-[10px_30px] p-[8px_20px]",children:"Profilni tahrirlash"})})]}),e.jsxs("div",{className:"relative h-full sm:w-[22%] w-full sm:block hidden",children:[e.jsx("img",{className:"aspect-[25/16] h-full w-full",src:$,alt:"Student's Plastic card"}),e.jsxs("p",{className:"absolute bottom-20 left-5 font-medium text-xl text-white",children:[(v=s==null?void 0:s.amount)!=null&&v.balance?(I=s==null?void 0:s.amount)==null?void 0:I.balance.toFixed(1):0," ","UZS"]}),e.jsx("p",{className:"absolute bottom-3 left-3 text-base text-white",children:s==null?void 0:s.payment_id})]})]}),e.jsxs("div",{className:"relative mt-14 sm:mb-10 mb-0",children:[e.jsx("h1",{className:"title absolute top-0",children:"Sotib olingan kurslar"}),e.jsx(b,{slidesPerView:1.2,spaceBetween:10,navigation:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:16},768:{slidesPerView:3,spaceBetween:16},1024:{slidesPerView:4,spaceBetween:16}},freeMode:!0,modules:[j,w],className:"mySwiper",children:(_=(F=p==null?void 0:p.data)==null?void 0:F.data)==null?void 0:_.map(a=>e.jsx(g,{children:e.jsx(k,{item:a,buy:!0,type:!0})},a==null?void 0:a.id))})]}),e.jsxs("div",{className:"relative sm:mt-14 mt-0 sm:mb-14 mb-4",children:[e.jsx("h1",{className:"title absolute top-0",children:"Saqlangan kurslar"}),e.jsx(b,{slidesPerView:1.2,spaceBetween:10,navigation:!0,freeMode:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:16},768:{slidesPerView:3,spaceBetween:16},1024:{slidesPerView:4,spaceBetween:16}},modules:[j,w],className:"mySwiper",children:(S=(E=u==null?void 0:u.data)==null?void 0:E.data)==null?void 0:S.map(a=>e.jsx(g,{className:"",children:e.jsx(k,{save:!0,item:a})},a==null?void 0:a.id))})]}),e.jsxs("div",{className:"relative sm:mt-14 mt-0 sm:mb-5 mb-10",children:[e.jsx("h1",{className:"title absolute top-0",children:"Obunalar"}),e.jsx(b,{slidesPerView:2,spaceBetween:15,navigation:!0,freeMode:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:20},768:{slidesPerView:4,spaceBetween:24},1024:{slidesPerView:5,spaceBetween:24},1440:{slidesPerView:6,spaceBetween:24}},modules:[j,w],className:"mySwiper",children:h==null?void 0:h.map(a=>{var l,n;return e.jsx(g,{className:"",children:e.jsx(Y,{item:(l=a==null?void 0:a.data)==null?void 0:l.data,type:!0})},(n=a==null?void 0:a.data)==null?void 0:n.data.id)})})]}),e.jsx(J,{title:"Profilni tahrirlash",onClose:()=>m(!1),open:C,children:e.jsx(r,{layout:"vertical",className:"w-full",onSubmitCapture:a=>{a.preventDefault(),G()},children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Ism"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.first_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Ismingizni kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Familiya"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.last_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Familiyangizni kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Foydalanuvchi nomi"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.user_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Foydalanuvchi nomini kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{className:"",label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Email"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.email",render:({field:a})=>e.jsx(d,{...a,type:"email",placeholder:"email@gmail.com",className:"w-full py-3 px-5 rounded-[10px]"})})}),e.jsx("button",{type:"submit",className:"w-full text-base py-2 text-white rounded-2xl bg-blue_color cursor-pointer transition-opacity hover:opacity-85",children:"Saqlash"})]})})})]})};export{oe as default};
