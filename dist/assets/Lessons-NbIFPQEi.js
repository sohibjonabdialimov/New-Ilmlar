import{u as G,r,a as V,L as B,b as v,j as e,S as F,D as O,h as T,G as q}from"./index-sr5zWOU9.js";import{P as z}from"./player.es-Dnu63r5Q.js";const M=()=>{var N,g,y;const f=G(),[m,w]=r.useState(null),{id:o,lessonId:c}=V(),[I,p]=r.useState(!1),[k,h]=r.useState(!1),[$,j]=r.useState(!1),{lessons:l,setLessons:b,isPurchased:d}=r.useContext(B),{data:u}=v(["GetCourseDetailWithoutToken",o],()=>T(o),{enabled:!!o});r.useEffect(()=>{var s,a;(a=(s=u==null?void 0:u.data)==null?void 0:s.data)!=null&&a.videos&&b(u.data.data.videos)},[u,b]);const{data:t,isLoading:_}=v(["GetVideoInfo",c,o],()=>q(c),{enabled:!!c&&!!o,onSuccess(s){w(s.data.data.video_link.split("/")[s.data.data.video_link.split("/").length-1])}});r.useEffect(()=>{const s=document.querySelector("iframe");if(s){const a=new z(s);a.on("play",()=>{console.log("Played the video")}),a.getVideoTitle().then(n=>{console.log("title:",n)})}},[m]);function C(s,a){(a||d)&&(f(`/course/${s}/lesson/${s}`),p(!1))}r.useEffect(()=>{var n,i,x;const s=l.findIndex(E=>E.id===+c),a=d?!!((n=l[s+1])!=null&&n.id):!!((i=l[s+1])!=null&&i.id)&&((x=l[s+1])==null?void 0:x.is_free);s!==-1&&(h(!s),j(!a))},[l,c,d]);function L(s){var i;const a=l.findIndex(x=>x.id===s),n=(i=l[a+1])==null?void 0:i.id;n&&(j(!1),f(`/course/${s}/lesson/${n}`))}function S(s){var i;const a=l.findIndex(x=>x.id===s),n=(i=l[a-1])==null?void 0:i.id;n&&(h(!1),f(`/course/${s}/lesson/${n}`))}function P(){f(d?`/my-course/${o}`:`/course/${o}`)}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"sm:py-7 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{onClick:P,className:"inline-flex items-center sm:gap-3 gap-1 cursor-pointer font-medium",children:[e.jsx("i",{className:"fa-solid fa-arrow-left sm:text-base text-xs"}),e.jsx("button",{className:"sm:text-lg text-sm",children:"Ortga qaytish"})]}),e.jsx("div",{className:"cursor-pointer mobile_lessons_menu",onClick:()=>p(!0),children:e.jsx("i",{className:"fa-solid fa-list-ul text-xl"})})]}),e.jsxs("div",{className:"sm:pt-5 pt-3",children:[e.jsx("div",{className:"h-[50%] rounded-[16px]",children:_?e.jsx("div",{className:"flex justify-center h-[10rem] items-center",children:e.jsx(F,{size:"large"})}):m?e.jsx("iframe",{src:`https://player.vimeo.com/video/${m}?h=2ac395a2694246448051ee01faf135ce&title=0&byline=0&portrait=0`,className:"w-full aspect-[7/4] rounded-[16px]",frameBorder:0,allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0}):e.jsx("p",{children:"Video topilmadi yoki noto'g'ri ID."})}),e.jsxs("div",{children:[e.jsx("h1",{className:"sm:text-2xl text-lg sm:pt-7 pt-4 font-semibold sm:pb-3 pb-2 text-main_color",children:(N=t==null?void 0:t.data.data)==null?void 0:N.title}),e.jsx("p",{className:"text-[#758195] pb-6 sm:text-lg text-sm",children:(g=t==null?void 0:t.data.data)==null?void 0:g.description}),e.jsx("div",{className:"sm:mb-6 mb-4",children:e.jsx("a",{href:(y=t==null?void 0:t.data.data)==null?void 0:y.file,className:"text-blue_color sm:text-xl text-base font-normal underline",children:"Darsga oid fayl"})}),e.jsx("hr",{}),e.jsxs("div",{className:"sm:mt-6 mt-4 flex justify-between",children:[e.jsxs("button",{onClick:()=>S(t==null?void 0:t.data.data.id),className:`flex items-center gap-3 ${k?"cursor-not-allowed opacity-35":"cursor-pointer opacity-100"}`,children:[e.jsx("i",{className:"fa-solid fa-arrow-left-long sm:text-xl text-base"}),e.jsx("span",{className:"sm:text-xl text-base",children:"Oldingi dars"})]}),e.jsxs("button",{onClick:()=>L(t==null?void 0:t.data.data.id),className:`flex items-center gap-3 ${$?"cursor-not-allowed opacity-35":"cursor-pointer opacity-100"}`,children:[e.jsx("span",{className:"sm:text-xl text-base",children:"Keyingi dars"}),e.jsx("i",{className:"fa-solid fa-arrow-right-long sm:text-xl text-base"})]})]})]})]}),e.jsx(O,{className:"lesson_drawer",title:e.jsx("h3",{className:"text-[20px] font-semibold",children:"Mavzular ro'yxati"}),onClose:()=>p(!1),open:I,children:e.jsx("div",{className:"fixed bg-[#fff] text-[#09090BFF] h-[100dvh] overflow-y-scroll py-5",children:e.jsx("ul",{children:l==null?void 0:l.map((s,a)=>e.jsxs("li",{onClick:()=>C(s.id,s.is_free),className:`px-4 flex transition-colors py-5 items-center border-b-2 gap-2 hover:bg-[#eee] ${s!=null&&s.is_free||d?"opacity-100 cursor-pointer select-auto":"opacity-40 cursor-not-allowed select-none"} ${(s==null?void 0:s.id)==c?"bg-[#dfdfdf]":"bg-transparent"}`,children:[s!=null&&s.is_free||d?e.jsx("i",{className:"fa-regular fa-circle-play inline-block text-base"}):e.jsx("i",{className:"fa-solid fa-lock inline-block text-base"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("p",{className:"text-base font-normal",children:["#",a+1,"."]}),e.jsx("h1",{className:"line-clamp-1 text-base font-normal",children:s.title})]})]},s.id))})})})]})})};export{M as default};
