import{r as o,J as O,P as G,s as L,b as f,aC as z,aD as M,aE as U,j as e,aF as H,D as A,F as r,M as c,z as d,aG as Q,aH as $,H as J}from"./index-nGmmVK93.js";import{t as K}from"./teacher_avatar-BnTJq1H-.js";import{S as b,f as j,N as w,a as g}from"./free-mode-CCMAUv7Z.js";import{N as _}from"./NewCourseCard-DsQj0LMy.js";import{T as Z}from"./TeachersGroupCard-ChizRtjs.js";import{u as W}from"./useQueries-CP01Rycc.js";import"./profile-CfCOq-MM.js";import"./formatPrice-DC00fQPP.js";const re=()=>{var P,v,I,F;const[E,m]=o.useState(!1),{control:i,getValues:S,setValue:t,reset:k}=O(),{userData:s,setUserData:C}=o.useContext(G),x=o.useRef(null),[N,T]=L.useMessage(),{refetch:y}=f(["GetUsersUserme"],()=>z(localStorage.getItem("token")),{enabled:!!localStorage.getItem("token"),onSuccess:a=>{C(a.data.data)}});o.useEffect(()=>{t("EDITPROFILE.user_name",s.user_name),t("EDITPROFILE.first_name",s.first_name),t("EDITPROFILE.last_name",s.last_name),t("EDITPROFILE.email",s.email)},[s,t]);const B=()=>{x.current&&x.current.click()},V=a=>{const l=a.target.files[0];l&&Q({file:l}).then(()=>{y(),N.open({type:"info",content:"Rasm o'zgartirildi"})}).catch(n=>{console.log(n),N.open({type:"error",content:"Rasm yuklashda xatolik bor"})})},R=async()=>{const a=S().EDITPROFILE;console.log(a),$(a).then(()=>{y(),k(),m(!1)}).catch(l=>{console.log(l)})},{data:p}=f(["GetPurchasedCourses"],M,{enabled:!!(s!=null&&s.id)}),{data:u}=f(["GetSavedCourses"],U,{enabled:!!(s!=null&&s.id)}),q=async a=>{const{data:l}=await J.get(`/api/users/teacheraccout/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}});return l},h=W(s==null?void 0:s.subscribedTeachers.map(a=>({queryKey:["data",a],queryFn:()=>q(a),enabled:!!(s!=null&&s.subscribedTeachers.length)})));return e.jsxs("div",{className:"py-7",children:[T,e.jsxs("div",{className:"flex sm:flex-row flex-col justify-between sm:mb-16 mb-0",children:[e.jsxs("div",{className:"sm:w-[78%] w-full",children:[e.jsxs("div",{className:"flex sm:flex-row flex-col items-center sm:gap-5 gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{className:"sm:w-[142px] sm:h-[142px] object-cover w-[90px] h-[90px] rounded-full",src:s!=null&&s.profile_img?s==null?void 0:s.profile_img:K,alt:"Ilmlar o'qituvchisining rasmi"}),e.jsx("div",{onClick:B,className:"border rounded-3xl translate-x-1/2 right-1/2 p-[4px_5px] inline-block absolute -bottom-3 text-xs text-white bg-[#262C36FF] cursor-pointer",children:"O'zgartirish"}),e.jsx("input",{type:"file",ref:x,className:"hidden",onChange:V})]}),e.jsxs("div",{className:"flex justify-between flex-col items-center sm:items-start py-1",children:[e.jsxs("h1",{className:"text-main_color font-semibold text-xl mb-1",children:[s==null?void 0:s.first_name," ",s!=null&&s.last_name?s==null?void 0:s.last_name:""," ",s!=null&&s.middle_name?s==null?void 0:s.middle_name:""]}),e.jsxs("p",{className:"text-base font-semibold",children:["Foydalanuvchi nomi:"," ",e.jsx("span",{className:"font-normal",children:s==null?void 0:s.user_name})]}),e.jsxs("p",{className:"text-base font-semibold",children:["Email: ",e.jsx("span",{className:"font-normal",children:s==null?void 0:s.email})]}),e.jsxs("p",{className:"text-base font-semibold",children:["Sotib olgan kurslaringiz soni:"," ",e.jsx("span",{className:"font-normal",children:"2 ta"})]})]})]}),e.jsx("div",{className:"sm:mt-5 mt-2 flex sm:justify-start justify-center items-center",children:e.jsx("button",{onClick:()=>m(!0),className:"btn text-sm sm:p-[10px_30px] p-[8px_20px]",children:"Profilni tahrirlash"})})]}),e.jsxs("div",{className:"relative h-full sm:w-[22%] w-full sm:block hidden",children:[e.jsx("img",{className:"aspect-[25/16] h-full w-full",src:H,alt:"Student's Plastic card"}),e.jsxs("p",{className:"absolute bottom-20 left-5 font-medium text-xl text-white",children:[(P=s==null?void 0:s.amount)!=null&&P.balance?(v=s==null?void 0:s.amount)==null?void 0:v.balance.toFixed(1):0," ","UZS"]}),e.jsx("p",{className:"absolute bottom-3 left-3 text-base text-white",children:s==null?void 0:s.payment_id})]})]}),e.jsxs("div",{className:"relative mt-14 mb-14",children:[e.jsx("h1",{className:"title absolute top-0",children:"Sotib olingan kurslar"}),e.jsx(b,{slidesPerView:1.5,spaceBetween:16,navigation:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:16},768:{slidesPerView:3,spaceBetween:16},1024:{slidesPerView:4,spaceBetween:16}},freeMode:!0,modules:[j,w],className:"mySwiper",children:(I=p==null?void 0:p.data.data)==null?void 0:I.map(a=>e.jsx(g,{children:e.jsx(_,{item:a,buy:!0,type:!0})},a==null?void 0:a.id))})]}),e.jsxs("div",{className:"relative mt-14 mb-14",children:[e.jsx("h1",{className:"title absolute top-0",children:"Saqlangan kurslar"}),e.jsx(b,{slidesPerView:1.5,spaceBetween:16,navigation:!0,freeMode:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:16},768:{slidesPerView:3,spaceBetween:16},1024:{slidesPerView:4,spaceBetween:16}},modules:[j,w],className:"mySwiper",children:(F=u==null?void 0:u.data.data)==null?void 0:F.map(a=>e.jsx(g,{className:"",children:e.jsx(_,{save:!0,item:a})},a==null?void 0:a.id))})]}),e.jsxs("div",{className:"relative mt-14 sm:mb-5 mb-10",children:[e.jsx("h1",{className:"title absolute top-0",children:"Obunalar"}),e.jsx(b,{slidesPerView:2,spaceBetween:15,navigation:!0,freeMode:!0,breakpoints:{640:{slidesPerView:2,spaceBetween:20},768:{slidesPerView:4,spaceBetween:24},1024:{slidesPerView:5,spaceBetween:24},1440:{slidesPerView:6,spaceBetween:24}},modules:[j,w],className:"mySwiper",children:h==null?void 0:h.map(a=>{var l,n;return e.jsx(g,{className:"",children:e.jsx(Z,{item:(l=a==null?void 0:a.data)==null?void 0:l.data,type:!0})},(n=a==null?void 0:a.data)==null?void 0:n.data.id)})})]}),e.jsx(A,{title:"Profilni tahrirlash",onClose:()=>m(!1),open:E,children:e.jsx(r,{layout:"vertical",className:"w-full",onSubmitCapture:a=>{a.preventDefault(),R()},children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Ism"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.first_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Ismingizni kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Familiya"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.last_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Familiyangizni kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Foydalanuvchi nomi"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.user_name",render:({field:a})=>e.jsx(e.Fragment,{children:e.jsx(d,{...a,placeholder:"Foydalanuvchi nomini kiriting...",className:"w-full py-3 px-4 rounded-[10px]"})})})}),e.jsx(r.Item,{className:"",label:e.jsx("span",{className:"text-secondary_color font-semibold text-base",children:"Email"}),children:e.jsx(c,{rules:{required:"Field is required"},control:i,name:"EDITPROFILE.email",render:({field:a})=>e.jsx(d,{...a,type:"email",placeholder:"email@gmail.com",className:"w-full py-3 px-5 rounded-[10px]"})})}),e.jsx("button",{type:"submit",className:"w-full text-base py-2 text-white rounded-2xl bg-blue_color cursor-pointer transition-opacity hover:opacity-85",children:"Saqlash"})]})})})]})};export{re as default};
