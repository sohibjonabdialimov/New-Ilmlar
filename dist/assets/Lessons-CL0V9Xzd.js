import{u as F,r,a as O,L as T,b as $,j as e,S as q,D as z,h as W,G as K}from"./index-DaLwsWWZ.js";import{P as M}from"./player.es-Dnu63r5Q.js";const U=()=>{var y,v,w;const f=F(),[p,_]=r.useState(null),{id:n,lessonId:d}=O(),[C,h]=r.useState(!1),[j,b]=r.useState(!1),[L,N]=r.useState(!1),{lessons:a,setLessons:g,isPurchased:o}=r.useContext(T),{data:u}=$(["GetCourseDetailWithoutToken",n],()=>W(n),{enabled:!!n});r.useEffect(()=>{var s,t;(t=(s=u==null?void 0:u.data)==null?void 0:s.data)!=null&&t.videos&&g(u.data.data.videos)},[u,g]);const{data:l,isLoading:S}=$(["GetVideoInfo",d,n],()=>K(d),{enabled:!!d&&!!n,onSuccess(s){_(s.data.data.video_link.split("/")[s.data.data.video_link.split("/").length-1])}});r.useEffect(()=>{const s=document.querySelector("iframe");if(s){const t=new M(s);t.on("play",()=>{console.log("Played the video")}),t.getVideoTitle().then(i=>{console.log("title:",i)})}},[p]);function P(s,t){(t||o)&&(f(`/course/${s}/lesson/${s}`),h(!1))}r.useEffect(()=>{var i,x,c;const s=a.findIndex(m=>m.id===+d),t=o?!!((i=a[s+1])!=null&&i.id):!!((x=a[s+1])!=null&&x.id)&&((c=a[s+1])==null?void 0:c.is_free);s!==-1&&(b(!s),N(!t))},[a,d,o]);function E(s){var c,m,I,k;const t=a.findIndex(B=>B.id===s),i=(c=a[t+1])==null?void 0:c.id;(o?(m=a[t+1])!=null&&m.id:(I=a[t+1])!=null&&I.id&&((k=a[t+1])!=null&&k.is_free))&&f(`/course/${n}/lesson/${i}`)}function G(s){var x;const t=a.findIndex(c=>c.id===s),i=(x=a[t-1])==null?void 0:x.id;j||!i||f(`/course/${s}/lesson/${i}`)}function V(){f(o?`/my-course/${n}`:`/course/${n}`)}return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"sm:py-7 py-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{onClick:V,className:"inline-flex items-center sm:gap-3 gap-1 cursor-pointer font-medium",children:[e.jsx("i",{className:"fa-solid fa-arrow-left sm:text-base text-xs"}),e.jsx("button",{className:"sm:text-lg text-sm",children:"Ortga qaytish"})]}),e.jsx("div",{className:"cursor-pointer mobile_lessons_menu",onClick:()=>h(!0),children:e.jsx("i",{className:"fa-solid fa-list-ul text-xl"})})]}),e.jsxs("div",{className:"sm:pt-5 pt-3",children:[e.jsx("div",{className:"h-[50%] rounded-[16px]",children:S?e.jsx("div",{className:"flex justify-center h-[10rem] items-center",children:e.jsx(q,{size:"large"})}):p?e.jsx("iframe",{src:`https://player.vimeo.com/video/${p}?h=2ac395a2694246448051ee01faf135ce&title=0&byline=0&portrait=0`,className:"w-full aspect-[7/4] rounded-[16px]",frameBorder:0,allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0}):e.jsx("p",{children:"Video topilmadi yoki noto'g'ri ID."})}),e.jsxs("div",{children:[e.jsx("h1",{className:"sm:text-2xl text-lg sm:pt-7 pt-4 font-semibold sm:pb-3 pb-2 text-main_color",children:(y=l==null?void 0:l.data.data)==null?void 0:y.title}),e.jsx("p",{className:"text-[#758195] pb-6 sm:text-lg text-sm",children:(v=l==null?void 0:l.data.data)==null?void 0:v.description}),e.jsx("div",{className:"sm:mb-6 mb-4",children:e.jsx("a",{href:(w=l==null?void 0:l.data.data)==null?void 0:w.file,className:"text-blue_color sm:text-xl text-base font-normal underline",children:"Darsga oid fayl"})}),e.jsx("hr",{}),e.jsxs("div",{className:"sm:mt-6 mt-4 flex justify-between",children:[e.jsxs("button",{onClick:()=>G(l==null?void 0:l.data.data.id),className:`flex items-center gap-3 ${j?"cursor-not-allowed opacity-35":"cursor-pointer opacity-100"}`,children:[e.jsx("i",{className:"fa-solid fa-arrow-left-long sm:text-xl text-base"}),e.jsx("span",{className:"sm:text-xl text-base",children:"Oldingi dars"})]}),e.jsxs("button",{onClick:()=>E(l==null?void 0:l.data.data.id),className:`flex items-center gap-3 ${L?"cursor-not-allowed opacity-35":"cursor-pointer opacity-100"}`,children:[e.jsx("span",{className:"sm:text-xl text-base",children:"Keyingi dars"}),e.jsx("i",{className:"fa-solid fa-arrow-right-long sm:text-xl text-base"})]})]})]})]}),e.jsx(z,{className:"lesson_drawer",title:e.jsx("h3",{className:"text-[20px] font-semibold",children:"Mavzular ro'yxati"}),onClose:()=>h(!1),open:C,children:e.jsx("div",{className:"fixed bg-[#fff] text-[#09090BFF] h-[100dvh] overflow-y-scroll py-5",children:e.jsx("ul",{children:a==null?void 0:a.map((s,t)=>e.jsxs("li",{onClick:()=>P(s.id,s.is_free),className:`px-4 flex transition-colors py-5 items-center border-b-2 gap-2 hover:bg-[#eee] ${s!=null&&s.is_free||o?"opacity-100 cursor-pointer select-auto":"opacity-40 cursor-not-allowed select-none"} ${(s==null?void 0:s.id)==d?"bg-[#dfdfdf]":"bg-transparent"}`,children:[s!=null&&s.is_free||o?e.jsx("i",{className:"fa-regular fa-circle-play inline-block text-base"}):e.jsx("i",{className:"fa-solid fa-lock inline-block text-base"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("p",{className:"text-base font-normal",children:["#",t+1,"."]}),e.jsx("h1",{className:"line-clamp-1 text-base font-normal",children:s.title})]})]},s.id))})})})]})})};export{U as default};
